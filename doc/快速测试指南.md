# 快速测试指南 - DOCX格式支持

## ✅ 功能清单

### 已实现
- [x] 上传.docx文件
- [x] 自动提取文本
- [x] 文件大小显示
- [x] 拖拽上传
- [x] 下载为Word格式
- [x] 下载为TXT格式
- [x] 保持段落格式

## 🧪 测试步骤

### 测试1：上传Word文档
1. 打开应用
2. 点击"上传文档"区域
3. 选择一个.docx文件
4. 等待文本提取完成
5. 检查文本框中是否显示了提取的内容

**预期结果**：
- ✅ 文件名和大小正确显示
- ✅ 文本内容完整提取
- ✅ 段落格式保持

### 测试2：拖拽上传
1. 准备一个.docx文件
2. 拖拽到上传区域
3. 松开鼠标

**预期结果**：
- ✅ 文件自动上传
- ✅ 文本自动提取

### 测试3：改写并下载Word
1. 上传或输入文本
2. 选择改写模式
3. 点击"开始改写"
4. 等待改写完成
5. 点击"下载Word"按钮

**预期结果**：
- ✅ 生成.docx文件
- ✅ 文件可以用Word打开
- ✅ 内容完整
- ✅ 格式正确（微软雅黑，12pt）

### 测试4：下载TXT
1. 改写完成后
2. 点击"下载TXT"按钮

**预期结果**：
- ✅ 生成.txt文件
- ✅ 内容完整
- ✅ 格式保持

### 测试5：清除文件
1. 上传文件后
2. 点击文件卡片上的"X"按钮

**预期结果**：
- ✅ 文件信息清除
- ✅ 文本框清空
- ✅ 可以重新上传

## 📝 测试用例

### 用例1：小文件（<1MB）
```
文件：测试文档.docx
大小：50KB
内容：500字
预期：快速提取，正常改写
```

### 用例2：中等文件（1-5MB）
```
文件：论文.docx
大小：2MB
内容：5000字
预期：正常提取，分段改写
```

### 用例3：大文件（>5MB）
```
文件：长文档.docx
大小：8MB
内容：20000字
预期：提取较慢，建议分段
```

### 用例4：特殊格式
```
文件：包含表格和图片.docx
预期：只提取文本，忽略表格和图片
```

## 🐛 常见问题排查

### 问题1：上传后没反应
**检查**：
- 文件格式是否为.docx
- 文件大小是否超过10MB
- 浏览器控制台是否有错误

### 问题2：提取的文本乱码
**检查**：
- 文档是否包含特殊字符
- 文档编码是否正确
- 尝试重新保存文档为.docx

### 问题3：下载的Word打不开
**检查**：
- Word版本是否过旧（建议2016+）
- 文件扩展名是否正确
- 尝试用WPS打开

### 问题4：格式丢失
**说明**：
- 当前版本只保留段落结构
- 不保留字体颜色、加粗等格式
- 这是正常行为

## 🎯 性能测试

### 测试指标
- 文件上传时间
- 文本提取时间
- 改写处理时间
- Word生成时间
- 下载时间

### 基准数据
```
500字文档：
- 提取：<1秒
- 改写：3-5秒
- 生成：<1秒

2000字文档：
- 提取：1-2秒
- 改写：10-15秒（分段）
- 生成：1-2秒

5000字文档：
- 提取：2-3秒
- 改写：30-40秒（分段）
- 生成：2-3秒
```

## 📊 测试报告模板

```markdown
## 测试日期：2025-XX-XX

### 环境
- 浏览器：Chrome 120
- 操作系统：macOS
- 网络：正常

### 测试结果

#### 功能测试
- [ ] 上传Word文档
- [ ] 拖拽上传
- [ ] 文本提取
- [ ] 改写功能
- [ ] 下载Word
- [ ] 下载TXT
- [ ] 清除文件

#### 性能测试
- 小文件（500字）：✅ 正常
- 中等文件（2000字）：✅ 正常
- 大文件（5000字）：⚠️ 较慢

#### 问题记录
1. 问题描述
2. 复现步骤
3. 预期结果
4. 实际结果
5. 截图

### 总结
- 通过：X项
- 失败：X项
- 待优化：X项
```

## 🚀 快速验证命令

### 检查依赖
```bash
npm list mammoth docx file-saver
```

### 启动开发服务器
```bash
npm run dev
```

### 构建生产版本
```bash
npm run build
```

## 💡 测试技巧

1. **使用浏览器开发者工具**
   - 打开Console查看日志
   - 查看Network监控API调用
   - 检查文件下载情况

2. **准备测试文件**
   - 纯文本文档
   - 包含格式的文档
   - 包含表格的文档
   - 包含图片的文档

3. **对比测试**
   - 原文 vs 提取的文本
   - 改写前 vs 改写后
   - 下载的Word vs 原始Word

4. **边界测试**
   - 空文档
   - 超大文档
   - 特殊字符
   - 不同语言

## ✅ 验收标准

### 必须通过
- ✅ 能上传.docx文件
- ✅ 能正确提取文本
- ✅ 能改写文本
- ✅ 能下载Word格式
- ✅ 下载的Word能打开

### 建议通过
- ✅ 拖拽上传流畅
- ✅ 文件信息显示正确
- ✅ 错误提示友好
- ✅ 处理速度合理

### 可选通过
- ⏳ 保留部分格式
- ⏳ 支持批量处理
- ⏳ 支持PDF导出
